<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" template="/template2/index.xhtml">

	<ui:define name="pagecontent">
		<p:panel id="usersPanel">
			<p:dataTable styleClass="myTable" id="ListUsers" editable="true"
				value="#{User_managed_bean.listUsers}" var="u" rowKey="#{u.UId}">


				<p:column headerText="User Name">
					<h:outputText value="#{u.UName}" />
				</p:column>

				<p:column headerText="Login">
					<h:outputText value="#{u.ULogin}">

					</h:outputText>
				</p:column>

				<p:column headerText="Group">
					<h:outputText value="#{u.user_group.GName}" />
				</p:column>

				<p:column headerText="Mail">
					<h:outputText value="#{u.UMail}" />
				</p:column>

				<p:column headerText="Registration Number">
					<h:outputText value="#{u.UMatricule}" />
				</p:column>

				<p:column headerText="Departement">
					<h:outputText value="#{u.UDepart}" />
				</p:column>

				<p:column headerText="Creation Date">
					<h:outputText value="#{u.dateCreation}" />
				</p:column>

				<p:column headerText="State">
					<h:outputText value="#{u.etat}" class="label label-default" />
				</p:column>

				<p:column headerText="Actions" style="width:200px;">
					<p:panelGrid columns="2">
						<p:commandButton process="ListUsers" icon="ui-icon-pencil"
							value="update" ajax="true"
							style="color:#fff; background: rgb(28, 184, 65) ; border-color: #d73925 ;"
							title="Edit" action="#{User_managed_bean.onSelectUser}"
							update="editForm" oncomplete="PF('dlgEditUser').show();">
							<f:setPropertyActionListener value="#{u}"
								target="#{User_managed_bean.guiUser}" />
						</p:commandButton>

						<p:commandButton process="ListUsers" icon="ui-icon-trash"
							ajax="true" value="delete" styleClass="btn btn-danger"
							title="Delete" action="#{User_managed_bean.onDelete}"
							update="ListUsers">
							<f:setPropertyActionListener value="#{u}"
								target="#{User_managed_bean.guiUser}" />
						</p:commandButton>
					</p:panelGrid>
				</p:column>
			</p:dataTable>

			<f:facet name="footer">
				<p:commandButton value="Add User" icon="ui-icon-plusthick"
					styleClass="btn btn-primary" oncomplete="PF('dlgAddUser').show()" />
			</f:facet>
		</p:panel>

		<p:dialog id="addUserDialog" widgetVar="dlgAddUser">
			<h:form id="addUserForm">
				<p:growl id="msgs" showDetail="true" escape="false" />
				<p:panelGrid columns="2">
					<h:outputLabel value="User name" />
					<p:inputText value="#{User_managed_bean.guiUser.UName}" />

					<h:outputLabel value="Login" />
					<p:inputText value="#{User_managed_bean.guiUser.ULogin}">
						<p:ajax listener="#{User_managed_bean.ajaxLoginControl()}"
							update="addUserForm:msgs"></p:ajax>
					</p:inputText>

					<h:outputLabel value="Password" />
					<p:password value="#{User_managed_bean.UPwd}" />

					<h:outputLabel value="Group" />
					<p:selectOneMenu value="#{User_managed_bean.guiGroup}"
						converter="omnifaces.SelectItemsConverter">
						<f:selectItem itemLabel="Select a group :" itemValue="#{null}"
							noSelectionOption="true" />
						<f:selectItems value="#{User_managed_bean.listGroups}" var="g"
							itemLabel="#{g.GName}" itemValue="#{g}">
						</f:selectItems>
					</p:selectOneMenu>

					<h:outputLabel value="Mail" />
					<p:inputText value="#{User_managed_bean.guiUser.UMail}" />

					<h:outputLabel value="Registration Number" />
					<p:inputText value="#{User_managed_bean.guiUser.UMatricule}" />

					<h:outputLabel value="Departement" />
					<p:inputText value="#{User_managed_bean.guiUser.UDepart}" />

				</p:panelGrid>

				<p:separator />

				<p:commandButton value="Submit" update="addUserForm :usersPanel"
					ajax="true" styleClass="btn btn-primary"
					action="#{User_managed_bean.addUser}" icon="ui-icon-check"
					oncomplete="PF('dlgAddUser').hide()" />
				<p:commandButton value="Cancel" oncomplete="PF('dlgAddUser').hide()"
					ajax="true" styleClass="btn btn-danger"></p:commandButton>
			</h:form>
		</p:dialog>

		<p:dialog id="editUserdialog" widgetVar="dlgEditUser"
			header="Edit User" closable="true">
			<h:form id="editForm">
				<p:panelGrid columns="2">
					<h:outputLabel value="User name" />
					<p:inputText value="#{User_managed_bean.guiUser.UName}" />

					<h:outputLabel value="Login" />
					<p:inputText value="#{User_managed_bean.guiUser.ULogin}" />

					<h:outputLabel value="Group" />
					<p:selectOneMenu value="#{User_managed_bean.guiGroup}"
						converter="omnifaces.SelectItemsConverter">
						<f:selectItem
							itemLabel="#{User_managed_bean.guiUser.user_group.GName}"
							itemValue="#{User_managed_bean.guiGroup}" />
						<f:selectItems value="#{User_managed_bean.listGroups}" var="g"
							itemLabel="#{g.GName}" itemValue="#{g}">
						</f:selectItems>
					</p:selectOneMenu>

					<h:outputLabel value="Mail" />
					<p:inputText value="#{User_managed_bean.guiUser.UMail}" />

					<h:outputLabel value="Registration Number" />
					<p:inputText value="#{User_managed_bean.guiUser.UMatricule}" />

					<h:outputLabel value="Departement" />
					<p:inputText value="#{User_managed_bean.guiUser.UDepart}" />

					<h:outputLabel value="State" />
					<p:inputText value="#{User_managed_bean.guiUser.etat}" />

				</p:panelGrid>
				<p:commandButton value="Submit" update="ListUsers" ajax="true"
					styleClass="btn btn-primary" process="editForm"
					action="#{User_managed_bean.onEditUser()}"
					oncomplete="PF('dlgEditUser').hide()" />
				<p:commandButton value="Cancel" styleClass="btn btn-danger"
					ajax="true" oncomplete="PF('dlgEditUser').hide()" />
			</h:form>
		</p:dialog>

	</ui:define>
</ui:composition>